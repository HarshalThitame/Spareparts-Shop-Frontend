<app-navbar *ngIf="user.userRole === 'CUSTOMER'"></app-navbar>
<app-retailer-navbar *ngIf="user.userRole === 'RETAILER'"></app-retailer-navbar>
<app-mechanic-navbar *ngIf="user.userRole === 'MECHANIC'"></app-mechanic-navbar>

<div class="container-fluid mt-lg-5 px-3 px-md-5">
  <h5 class="text-start mb-4">Order Details</h5>

  <div class="card">
    <div class="card-header">
      <h6>Order ID: #{{ order.id }}</h6>
      <p>Status: <span class="badge badge-info text-dark">{{ order.status }}</span></p>
    </div>

    <div class="card-body">
      <h6 class="fw-bold">Customer Information</h6>
      <div class="row mb-3">
        <div class="col-md-6 mb-3 mb-md-0">
          <p><strong>Name:</strong> {{ order.user.firstName }} {{ order.user.lastName }}</p>
         <p><strong>Email:</strong> {{ order.user.email }}</p>
          <p><strong>Phone:</strong> {{ order.user.mobile }}</p>
        </div>
        <div class="col-md-6">
          <h6 class="fw-bold">Shipping Address:</h6>
          <p class="fw-bold">{{ order.shippingAddress.recipientName }}</p>
          <p>{{ order.shippingAddress.addressLine1 }}, {{ order.shippingAddress.addressLine2 }}</p>
          <p>{{ order.shippingAddress.city }}, {{ order.shippingAddress.state }} {{ order.shippingAddress.postalCode }}</p>
        </div>
      </div>

      <h6>Order Items</h6>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
          <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Unit Price</th>
            <th>GST</th>
            <th>Sub Total</th>
            <th>Discount</th>
            <th>Total</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let item of order.orderItems">
            <td>{{ item.product.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.price | currency: 'INR' }}</td>
            <td>{{ item.gst }}</td>
            <td>{{ item.subtotal | currency: 'INR' }}</td>
            <td>{{ getDiscount(item.price, item.discountOnPurchase, item.quantity) | currency: 'INR' }}</td>
            <td>{{ item.totalPrice | currency: 'INR' }}</td>
          </tr>
          </tbody>
        </table>
      </div>

      <h6 class="mt-4">Order Summary</h6>
      <div class="row">
        <div class="col-md-6">
          <div class="order-summary">
            <p>Subtotal: {{ getOrderSubtotal() | currency: 'INR' }}</p>
            <p>GST: {{ getOrderGst() | currency: 'INR' }}</p>
            <p>Shipping: {{ order.shippingCost | currency: 'INR' }}</p>
            <p>Discount: {{ getOrderDiscount() | currency: 'INR' }}</p>
            <p><strong>Total: {{ order.totalAmount | currency: 'INR' }}</strong></p>
          </div>
        </div>
        <div class="col-md-6 text-md-right">
          <strong>Total:</strong> <h4 class="text-success">{{ order.totalAmount | currency: 'INR' }}</h4>
        </div>
      </div>

      <div class="mt-4 d-flex flex-wrap justify-content-between">
        <button class="btn btn-primary m-2" (click)="goBack()">Back to Orders</button>
        <button class="btn btn-warning m-2" (click)="printOrder()">Print Order</button>
      </div>
    </div>
  </div>
</div>
